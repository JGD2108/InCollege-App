      IDENTIFICATION DIVISION.
       PROGRAM-ID. EDITPROFILE.

      ENVIRONMENT DIVISION.
        INPUT-OUTPUT SECTION.
        FILE-CONTROL.
          SELECT OPTIONAL PROFILES-FILE
             ASSIGN TO "PROFILES.DAT"
             ORGANIZATION IS LINE SEQUENTIAL
             FILE STATUS IS WS-PROFILES-STATUS.
          SELECT OPTIONAL EXPERIENCE-FILE
             ASSIGN TO "EXPERIENCE.DAT"
             ORGANIZATION IS LINE SEQUENTIAL
             FILE STATUS IS WS-EXPERIENCE-STATUS.
          SELECT OPTIONAL EDUCATION-FILE
             ASSIGN TO "EDUCATION.DAT"
             ORGANIZATION IS LINE SEQUENTIAL
             FILE STATUS IS WS-EDUCATION-STATUS.

      DATA DIVISION.
      FILE SECTION.
        FD PROFILES-FILE.
          01 PROFILE-RECORD.
            05 PROFILE-USERNAME PIC X(12).
            05 PROFILE-FIRST-NAME PIC X(20).
            05 PROFILE-LAST-NAME PIC X(20).
            05 PROFILE-COLLEGE PIC X(30).
            05 PROFILE-MAJOR PIC X(30).
            05 PROFILE-GRAD-YEAR PIC 9(4).
            05 PROFILE-ABOUT-ME PIC X(100).

        FD EXPERIENCE-FILE.
          01 EXPERIENCE-RECORD.
            05 EXPERIENCE-USERNAME PIC X(12).
            05 EXPERIENCE-INDEX PIC 9.
            05 EXPERIENCE-TITLE PIC X(30).
            05 EXPERIENCE-COMPANY PIC X(30).
            05 EXPERIENCE-START-DATE PIC X(10).
            05 EXPERIENCE-END-DATE PIC X(10).
            05 EXPERIENCE-DESC PIC X(100).

        FD EDUCATION-FILE.
          01 EDUCATION-RECORD.
            05 EDUCATION-USERNAME PIC X(12).
            05 EDUCATION-INDEX PIC 9.
            05 EDUCATION-DEGREE PIC X(30).
            05 EDUCATION-UNI PIC X(30).
            05 EDUCATION-START-YEAR PIC 9(4).
            05 EDUCATION-END-YEAR PIC 9(4).

      WORKING-STORAGE SECTION.
        77 WS-PROFILES-STATUS PIC XX.
        77 WS-EXPERIENCE-STATUS PIC XX.
        77 WS-EDUCATION-STATUS PIC XX.
        77 WS-PROFILE-EOF PIC X VALUE "N".
        77 WS-EXPERIENCE-EOF PIC X VALUE "N".
        77 WS-EDUCATION-EOF PIC X VALUE "N".
        77 WS-PROFILE-COUNT PIC 9 VALUE 0.
        77 WS-EXPERIENCE-COUNT PIC 99 VALUE 0.
        77 WS-EDUCATION-COUNT PIC 99 VALUE 0.
        77 WS-PROFILE-FOUND PIC X VALUE "N".
        77 WS-ENTRY-INDEX PIC 99 VALUE 0.
        77 WS-USER-EXPERIENCE-COUNT PIC 9 VALUE 0.
        77 WS-USER-EDUCATION-COUNT PIC 9 VALUE 0.
        77 WS-MAX-PROFILES PIC 9 VALUE 5.
        77 WS-MAX-EXPERIENCE-ENTRIES PIC 9 VALUE 3.
        77 WS-MAX-EDUCATION-ENTRIES PIC 9 VALUE 3.
        77 WS-MAX-EXPERIENCE-ROWS PIC 99 VALUE 15.
        77 WS-MAX-EDUCATION-ROWS PIC 99 VALUE 15.

        01 WS-PROFILE-TABLE.
          05 WS-PROFILE-ENTRY OCCURS 5 TIMES.
            10 WS-PROFILE-USERNAME PIC X(12).
            10 WS-PROFILE-FIRST-NAME PIC X(20).
            10 WS-PROFILE-LAST-NAME PIC X(20).
            10 WS-PROFILE-COLLEGE PIC X(30).
            10 WS-PROFILE-MAJOR PIC X(30).
            10 WS-PROFILE-GRAD-YEAR PIC 9(4).
            10 WS-PROFILE-ABOUT-ME PIC X(100).

        01 WS-EXPERIENCE-TABLE.
          05 WS-EXPERIENCE-ENTRY OCCURS 15 TIMES.
            10 WS-EXPERIENCE-USERNAME PIC X(12).
            10 WS-EXPERIENCE-INDEX PIC 9.
            10 WS-EXPERIENCE-TITLE PIC X(30).
            10 WS-EXPERIENCE-COMPANY PIC X(30).
            10 WS-EXPERIENCE-START-DATE PIC X(10).
            10 WS-EXPERIENCE-END-DATE PIC X(10).
            10 WS-EXPERIENCE-DESC PIC X(100).

        01 WS-EDUCATION-TABLE.
          05 WS-EDUCATION-ENTRY OCCURS 15 TIMES.
            10 WS-EDUCATION-USERNAME PIC X(12).
            10 WS-EDUCATION-INDEX PIC 9.
            10 WS-EDUCATION-DEGREE PIC X(30).
            10 WS-EDUCATION-UNI PIC X(30).
            10 WS-EDUCATION-START-YEAR PIC 9(4).
            10 WS-EDUCATION-END-YEAR PIC 9(4).

      LINKAGE SECTION.
        77 LK-USERNAME PIC X(12).
        01 LK-PROFILE-DATA.
          05 LK-FIRST-NAME PIC X(20).
          05 LK-LAST-NAME PIC X(20).
          05 LK-COLLEGE PIC X(30).
          05 LK-MAJOR PIC X(30).
          05 LK-GRAD-YEAR PIC 9(4).
          05 LK-ABOUT-ME PIC X(100).
        77 LK-PROFILE-ACTION PIC X(1).
        01 LK-EXPERIENCE.
          05 LK-EXP-TITLE PIC X(30).
          05 LK-EXP-COMPANY PIC X(30).
          05 LK-EXP-START-DATE PIC X(10).
          05 LK-EXP-END-DATE PIC X(10).
          05 LK-EXP-DESC PIC X(100).
        01 LK-EDUCATION.
          05 LK-EDU-DEGREE PIC X(30).
          05 LK-EDU-UNI PIC X(30).
          05 LK-EDU-START-YEAR PIC 9(4).
          05 LK-EDU-END-YEAR PIC 9(4).
        01 LK-VIEW-EXPERIENCE-LIST.
          05 LK-VIEW-EXP-ENTRY OCCURS 3 TIMES.
            10 LK-VIEW-EXP-TITLE PIC X(30).
            10 LK-VIEW-EXP-COMPANY PIC X(30).
            10 LK-VIEW-EXP-START-DATE PIC X(10).
            10 LK-VIEW-EXP-END-DATE PIC X(10).
            10 LK-VIEW-EXP-DESC PIC X(100).
        01 LK-VIEW-EDUCATION-LIST.
          05 LK-VIEW-EDU-ENTRY OCCURS 3 TIMES.
            10 LK-VIEW-EDU-DEGREE PIC X(30).
            10 LK-VIEW-EDU-UNI PIC X(30).
            10 LK-VIEW-EDU-START-YEAR PIC 9(4).
            10 LK-VIEW-EDU-END-YEAR PIC 9(4).
        77 LK-VIEW-EXP-COUNT PIC 9.
        77 LK-VIEW-EDU-COUNT PIC 9.
        77 LK-PROFILE-FOUND PIC X.
        77 LK-MESSAGE PIC X(100).

      PROCEDURE DIVISION.
      MAIN-ENTRY.
        GOBACK.

      ENTRY "BASIC" USING LK-USERNAME LK-PROFILE-DATA LK-PROFILE-ACTION LK-MESSAGE.
        PERFORM UPSERT-PROFILE
        GOBACK.

      ENTRY "EXPERIENCE" USING LK-USERNAME LK-EXPERIENCE LK-PROFILE-ACTION LK-MESSAGE.
        PERFORM ADD-EXPERIENCE
        GOBACK.

      ENTRY "EDUCATION" USING LK-USERNAME LK-EDUCATION LK-PROFILE-ACTION LK-MESSAGE.
        PERFORM ADD-EDUCATION
        GOBACK.

      ENTRY "VIEWPROFILE" USING LK-USERNAME LK-PROFILE-DATA
                                LK-VIEW-EXPERIENCE-LIST LK-VIEW-EDUCATION-LIST
                                LK-VIEW-EXP-COUNT LK-VIEW-EDU-COUNT
                                LK-PROFILE-FOUND LK-MESSAGE.
        PERFORM VIEW-PROFILE
        GOBACK.

      LOAD-PROFILES.
        MOVE 0 TO WS-PROFILE-COUNT
        MOVE "N" TO WS-PROFILE-EOF
        OPEN INPUT PROFILES-FILE
        IF WS-PROFILES-STATUS = "35"
          OPEN OUTPUT PROFILES-FILE
          CLOSE PROFILES-FILE
          OPEN INPUT PROFILES-FILE
        END-IF
        IF WS-PROFILES-STATUS NOT = "00"
          MOVE "Unable to open PROFILES.DAT." TO LK-MESSAGE
          CLOSE PROFILES-FILE
          GOBACK
        END-IF
        PERFORM UNTIL WS-PROFILE-EOF = "Y" OR WS-PROFILE-COUNT >= WS-MAX-PROFILES
          READ PROFILES-FILE
            AT END
              MOVE "Y" TO WS-PROFILE-EOF
            NOT AT END
              ADD 1 TO WS-PROFILE-COUNT
              MOVE PROFILE-USERNAME TO WS-PROFILE-USERNAME(WS-PROFILE-COUNT)
              MOVE PROFILE-FIRST-NAME TO WS-PROFILE-FIRST-NAME(WS-PROFILE-COUNT)
              MOVE PROFILE-LAST-NAME TO WS-PROFILE-LAST-NAME(WS-PROFILE-COUNT)
              MOVE PROFILE-COLLEGE TO WS-PROFILE-COLLEGE(WS-PROFILE-COUNT)
              MOVE PROFILE-MAJOR TO WS-PROFILE-MAJOR(WS-PROFILE-COUNT)
              MOVE PROFILE-GRAD-YEAR TO WS-PROFILE-GRAD-YEAR(WS-PROFILE-COUNT)
              MOVE PROFILE-ABOUT-ME TO WS-PROFILE-ABOUT-ME(WS-PROFILE-COUNT)
          END-READ
        END-PERFORM
        CLOSE PROFILES-FILE.

      SAVE-PROFILES.
        OPEN OUTPUT PROFILES-FILE
        IF WS-PROFILES-STATUS NOT = "00"
          MOVE "Unable to write PROFILES.DAT." TO LK-MESSAGE
          CLOSE PROFILES-FILE
          GOBACK
        END-IF
        PERFORM VARYING WS-ENTRY-INDEX FROM 1 BY 1 UNTIL WS-ENTRY-INDEX > WS-PROFILE-COUNT
          MOVE WS-PROFILE-USERNAME(WS-ENTRY-INDEX) TO PROFILE-USERNAME
          MOVE WS-PROFILE-FIRST-NAME(WS-ENTRY-INDEX) TO PROFILE-FIRST-NAME
          MOVE WS-PROFILE-LAST-NAME(WS-ENTRY-INDEX) TO PROFILE-LAST-NAME
          MOVE WS-PROFILE-COLLEGE(WS-ENTRY-INDEX) TO PROFILE-COLLEGE
          MOVE WS-PROFILE-MAJOR(WS-ENTRY-INDEX) TO PROFILE-MAJOR
          MOVE WS-PROFILE-GRAD-YEAR(WS-ENTRY-INDEX) TO PROFILE-GRAD-YEAR
          MOVE WS-PROFILE-ABOUT-ME(WS-ENTRY-INDEX) TO PROFILE-ABOUT-ME
          WRITE PROFILE-RECORD
        END-PERFORM
        CLOSE PROFILES-FILE.

      UPSERT-PROFILE.
        PERFORM LOAD-PROFILES
        MOVE "N" TO WS-PROFILE-FOUND
        PERFORM VARYING WS-ENTRY-INDEX FROM 1 BY 1
          UNTIL WS-ENTRY-INDEX > WS-PROFILE-COUNT OR WS-PROFILE-FOUND = "Y"
          IF FUNCTION TRIM(WS-PROFILE-USERNAME(WS-ENTRY-INDEX))
            = FUNCTION TRIM(LK-USERNAME)
            MOVE "Y" TO WS-PROFILE-FOUND
            MOVE FUNCTION TRIM(LK-USERNAME) TO WS-PROFILE-USERNAME(WS-ENTRY-INDEX)
            MOVE FUNCTION TRIM(LK-FIRST-NAME) TO WS-PROFILE-FIRST-NAME(WS-ENTRY-INDEX)
            MOVE FUNCTION TRIM(LK-LAST-NAME) TO WS-PROFILE-LAST-NAME(WS-ENTRY-INDEX)
            MOVE FUNCTION TRIM(LK-COLLEGE) TO WS-PROFILE-COLLEGE(WS-ENTRY-INDEX)
            MOVE FUNCTION TRIM(LK-MAJOR) TO WS-PROFILE-MAJOR(WS-ENTRY-INDEX)
            MOVE LK-GRAD-YEAR TO WS-PROFILE-GRAD-YEAR(WS-ENTRY-INDEX)
            MOVE FUNCTION TRIM(LK-ABOUT-ME) TO WS-PROFILE-ABOUT-ME(WS-ENTRY-INDEX)
          END-IF
        END-PERFORM
        IF WS-PROFILE-FOUND = "N"
          IF WS-PROFILE-COUNT >= WS-MAX-PROFILES
            MOVE "Profile limit reached." TO LK-MESSAGE
            GOBACK
          END-IF
          ADD 1 TO WS-PROFILE-COUNT
          MOVE FUNCTION TRIM(LK-USERNAME) TO WS-PROFILE-USERNAME(WS-PROFILE-COUNT)
          MOVE FUNCTION TRIM(LK-FIRST-NAME) TO WS-PROFILE-FIRST-NAME(WS-PROFILE-COUNT)
          MOVE FUNCTION TRIM(LK-LAST-NAME) TO WS-PROFILE-LAST-NAME(WS-PROFILE-COUNT)
          MOVE FUNCTION TRIM(LK-COLLEGE) TO WS-PROFILE-COLLEGE(WS-PROFILE-COUNT)
          MOVE FUNCTION TRIM(LK-MAJOR) TO WS-PROFILE-MAJOR(WS-PROFILE-COUNT)
          MOVE LK-GRAD-YEAR TO WS-PROFILE-GRAD-YEAR(WS-PROFILE-COUNT)
          MOVE FUNCTION TRIM(LK-ABOUT-ME) TO WS-PROFILE-ABOUT-ME(WS-PROFILE-COUNT)
        END-IF
        PERFORM SAVE-PROFILES
        IF WS-PROFILE-FOUND = "Y"
          MOVE "Profile updated." TO LK-MESSAGE
        ELSE
          MOVE "Profile created." TO LK-MESSAGE
        END-IF.

      LOAD-EXPERIENCE.
        MOVE 0 TO WS-EXPERIENCE-COUNT
        MOVE "N" TO WS-EXPERIENCE-EOF
        OPEN INPUT EXPERIENCE-FILE
        IF WS-EXPERIENCE-STATUS = "35"
          OPEN OUTPUT EXPERIENCE-FILE
          CLOSE EXPERIENCE-FILE
          OPEN INPUT EXPERIENCE-FILE
        END-IF
        IF WS-EXPERIENCE-STATUS NOT = "00"
          MOVE "Unable to open EXPERIENCE.DAT." TO LK-MESSAGE
          CLOSE EXPERIENCE-FILE
          GOBACK
        END-IF
        PERFORM UNTIL WS-EXPERIENCE-EOF = "Y" OR WS-EXPERIENCE-COUNT >= WS-MAX-EXPERIENCE-ROWS
          READ EXPERIENCE-FILE
            AT END
              MOVE "Y" TO WS-EXPERIENCE-EOF
            NOT AT END
              ADD 1 TO WS-EXPERIENCE-COUNT
              MOVE EXPERIENCE-USERNAME TO WS-EXPERIENCE-USERNAME(WS-EXPERIENCE-COUNT)
              MOVE EXPERIENCE-INDEX TO WS-EXPERIENCE-INDEX(WS-EXPERIENCE-COUNT)
              MOVE EXPERIENCE-TITLE TO WS-EXPERIENCE-TITLE(WS-EXPERIENCE-COUNT)
              MOVE EXPERIENCE-COMPANY TO WS-EXPERIENCE-COMPANY(WS-EXPERIENCE-COUNT)
              MOVE EXPERIENCE-START-DATE TO WS-EXPERIENCE-START-DATE(WS-EXPERIENCE-COUNT)
              MOVE EXPERIENCE-END-DATE TO WS-EXPERIENCE-END-DATE(WS-EXPERIENCE-COUNT)
              MOVE EXPERIENCE-DESC TO WS-EXPERIENCE-DESC(WS-EXPERIENCE-COUNT)
          END-READ
        END-PERFORM
        CLOSE EXPERIENCE-FILE.

      SAVE-EXPERIENCE.
        OPEN OUTPUT EXPERIENCE-FILE
        IF WS-EXPERIENCE-STATUS NOT = "00"
          MOVE "Unable to write EXPERIENCE.DAT." TO LK-MESSAGE
          CLOSE EXPERIENCE-FILE
          GOBACK
        END-IF
        PERFORM VARYING WS-ENTRY-INDEX FROM 1 BY 1
          UNTIL WS-ENTRY-INDEX > WS-EXPERIENCE-COUNT
          MOVE WS-EXPERIENCE-USERNAME(WS-ENTRY-INDEX) TO EXPERIENCE-USERNAME
          MOVE WS-EXPERIENCE-INDEX(WS-ENTRY-INDEX) TO EXPERIENCE-INDEX
          MOVE WS-EXPERIENCE-TITLE(WS-ENTRY-INDEX) TO EXPERIENCE-TITLE
          MOVE WS-EXPERIENCE-COMPANY(WS-ENTRY-INDEX) TO EXPERIENCE-COMPANY
          MOVE WS-EXPERIENCE-START-DATE(WS-ENTRY-INDEX) TO EXPERIENCE-START-DATE
          MOVE WS-EXPERIENCE-END-DATE(WS-ENTRY-INDEX) TO EXPERIENCE-END-DATE
          MOVE WS-EXPERIENCE-DESC(WS-ENTRY-INDEX) TO EXPERIENCE-DESC
          WRITE EXPERIENCE-RECORD
        END-PERFORM
        CLOSE EXPERIENCE-FILE.

      ADD-EXPERIENCE.
        PERFORM LOAD-EXPERIENCE
        MOVE 0 TO WS-USER-EXPERIENCE-COUNT
        PERFORM VARYING WS-ENTRY-INDEX FROM 1 BY 1
          UNTIL WS-ENTRY-INDEX > WS-EXPERIENCE-COUNT
          IF FUNCTION TRIM(WS-EXPERIENCE-USERNAME(WS-ENTRY-INDEX))
            = FUNCTION TRIM(LK-USERNAME)
            ADD 1 TO WS-USER-EXPERIENCE-COUNT
          END-IF
        END-PERFORM
        IF WS-USER-EXPERIENCE-COUNT >= WS-MAX-EXPERIENCE-ENTRIES
          MOVE "Experience limit reached (max 3)." TO LK-MESSAGE
          GOBACK
        END-IF
        IF WS-EXPERIENCE-COUNT >= WS-MAX-EXPERIENCE-ROWS
          MOVE "Experience storage is full." TO LK-MESSAGE
          GOBACK
        END-IF
        ADD 1 TO WS-EXPERIENCE-COUNT
        MOVE FUNCTION TRIM(LK-USERNAME) TO WS-EXPERIENCE-USERNAME(WS-EXPERIENCE-COUNT)
        COMPUTE WS-EXPERIENCE-INDEX(WS-EXPERIENCE-COUNT)
          = WS-USER-EXPERIENCE-COUNT + 1
        MOVE FUNCTION TRIM(LK-EXP-TITLE) TO WS-EXPERIENCE-TITLE(WS-EXPERIENCE-COUNT)
        MOVE FUNCTION TRIM(LK-EXP-COMPANY) TO WS-EXPERIENCE-COMPANY(WS-EXPERIENCE-COUNT)
        MOVE FUNCTION TRIM(LK-EXP-START-DATE) TO WS-EXPERIENCE-START-DATE(WS-EXPERIENCE-COUNT)
        MOVE FUNCTION TRIM(LK-EXP-END-DATE) TO WS-EXPERIENCE-END-DATE(WS-EXPERIENCE-COUNT)
        MOVE FUNCTION TRIM(LK-EXP-DESC) TO WS-EXPERIENCE-DESC(WS-EXPERIENCE-COUNT)
        PERFORM SAVE-EXPERIENCE
        MOVE "Experience saved." TO LK-MESSAGE.

      LOAD-EDUCATION.
        MOVE 0 TO WS-EDUCATION-COUNT
        MOVE "N" TO WS-EDUCATION-EOF
        OPEN INPUT EDUCATION-FILE
        IF WS-EDUCATION-STATUS = "35"
          OPEN OUTPUT EDUCATION-FILE
          CLOSE EDUCATION-FILE
          OPEN INPUT EDUCATION-FILE
        END-IF
        IF WS-EDUCATION-STATUS NOT = "00"
          MOVE "Unable to open EDUCATION.DAT." TO LK-MESSAGE
          CLOSE EDUCATION-FILE
          GOBACK
        END-IF
        PERFORM UNTIL WS-EDUCATION-EOF = "Y" OR WS-EDUCATION-COUNT >= WS-MAX-EDUCATION-ROWS
          READ EDUCATION-FILE
            AT END
              MOVE "Y" TO WS-EDUCATION-EOF
            NOT AT END
              ADD 1 TO WS-EDUCATION-COUNT
              MOVE EDUCATION-USERNAME TO WS-EDUCATION-USERNAME(WS-EDUCATION-COUNT)
              MOVE EDUCATION-INDEX TO WS-EDUCATION-INDEX(WS-EDUCATION-COUNT)
              MOVE EDUCATION-DEGREE TO WS-EDUCATION-DEGREE(WS-EDUCATION-COUNT)
              MOVE EDUCATION-UNI TO WS-EDUCATION-UNI(WS-EDUCATION-COUNT)
              MOVE EDUCATION-START-YEAR TO WS-EDUCATION-START-YEAR(WS-EDUCATION-COUNT)
              MOVE EDUCATION-END-YEAR TO WS-EDUCATION-END-YEAR(WS-EDUCATION-COUNT)
          END-READ
        END-PERFORM
        CLOSE EDUCATION-FILE.

      SAVE-EDUCATION.
        OPEN OUTPUT EDUCATION-FILE
        IF WS-EDUCATION-STATUS NOT = "00"
          MOVE "Unable to write EDUCATION.DAT." TO LK-MESSAGE
          CLOSE EDUCATION-FILE
          GOBACK
        END-IF
        PERFORM VARYING WS-ENTRY-INDEX FROM 1 BY 1
          UNTIL WS-ENTRY-INDEX > WS-EDUCATION-COUNT
          MOVE WS-EDUCATION-USERNAME(WS-ENTRY-INDEX) TO EDUCATION-USERNAME
          MOVE WS-EDUCATION-INDEX(WS-ENTRY-INDEX) TO EDUCATION-INDEX
          MOVE WS-EDUCATION-DEGREE(WS-ENTRY-INDEX) TO EDUCATION-DEGREE
          MOVE WS-EDUCATION-UNI(WS-ENTRY-INDEX) TO EDUCATION-UNI
          MOVE WS-EDUCATION-START-YEAR(WS-ENTRY-INDEX) TO EDUCATION-START-YEAR
          MOVE WS-EDUCATION-END-YEAR(WS-ENTRY-INDEX) TO EDUCATION-END-YEAR
          WRITE EDUCATION-RECORD
        END-PERFORM
        CLOSE EDUCATION-FILE.

      ADD-EDUCATION.
        PERFORM LOAD-EDUCATION
        MOVE 0 TO WS-USER-EDUCATION-COUNT
        PERFORM VARYING WS-ENTRY-INDEX FROM 1 BY 1
          UNTIL WS-ENTRY-INDEX > WS-EDUCATION-COUNT
          IF FUNCTION TRIM(WS-EDUCATION-USERNAME(WS-ENTRY-INDEX))
            = FUNCTION TRIM(LK-USERNAME)
            ADD 1 TO WS-USER-EDUCATION-COUNT
          END-IF
        END-PERFORM
        IF WS-USER-EDUCATION-COUNT >= WS-MAX-EDUCATION-ENTRIES
          MOVE "Education limit reached (max 3)." TO LK-MESSAGE
          GOBACK
        END-IF
        IF WS-EDUCATION-COUNT >= WS-MAX-EDUCATION-ROWS
          MOVE "Education storage is full." TO LK-MESSAGE
          GOBACK
        END-IF
        ADD 1 TO WS-EDUCATION-COUNT
        MOVE FUNCTION TRIM(LK-USERNAME) TO WS-EDUCATION-USERNAME(WS-EDUCATION-COUNT)
        COMPUTE WS-EDUCATION-INDEX(WS-EDUCATION-COUNT)
          = WS-USER-EDUCATION-COUNT + 1
        MOVE FUNCTION TRIM(LK-EDU-DEGREE) TO WS-EDUCATION-DEGREE(WS-EDUCATION-COUNT)
        MOVE FUNCTION TRIM(LK-EDU-UNI) TO WS-EDUCATION-UNI(WS-EDUCATION-COUNT)
        MOVE LK-EDU-START-YEAR TO WS-EDUCATION-START-YEAR(WS-EDUCATION-COUNT)
        MOVE LK-EDU-END-YEAR TO WS-EDUCATION-END-YEAR(WS-EDUCATION-COUNT)
        PERFORM SAVE-EDUCATION
        MOVE "Education saved." TO LK-MESSAGE.

      VIEW-PROFILE.
        MOVE "N" TO LK-PROFILE-FOUND
        MOVE 0 TO LK-VIEW-EXP-COUNT
        MOVE 0 TO LK-VIEW-EDU-COUNT
        MOVE SPACES TO LK-PROFILE-DATA
        MOVE SPACES TO LK-VIEW-EXPERIENCE-LIST
        MOVE SPACES TO LK-VIEW-EDUCATION-LIST

        PERFORM LOAD-PROFILES
        PERFORM VARYING WS-ENTRY-INDEX FROM 1 BY 1
          UNTIL WS-ENTRY-INDEX > WS-PROFILE-COUNT OR LK-PROFILE-FOUND = "Y"
          IF FUNCTION TRIM(WS-PROFILE-USERNAME(WS-ENTRY-INDEX))
            = FUNCTION TRIM(LK-USERNAME)
            MOVE "Y" TO LK-PROFILE-FOUND
            MOVE WS-PROFILE-FIRST-NAME(WS-ENTRY-INDEX) TO LK-FIRST-NAME
            MOVE WS-PROFILE-LAST-NAME(WS-ENTRY-INDEX) TO LK-LAST-NAME
            MOVE WS-PROFILE-COLLEGE(WS-ENTRY-INDEX) TO LK-COLLEGE
            MOVE WS-PROFILE-MAJOR(WS-ENTRY-INDEX) TO LK-MAJOR
            MOVE WS-PROFILE-GRAD-YEAR(WS-ENTRY-INDEX) TO LK-GRAD-YEAR
            MOVE WS-PROFILE-ABOUT-ME(WS-ENTRY-INDEX) TO LK-ABOUT-ME
          END-IF
        END-PERFORM

        IF LK-PROFILE-FOUND = "N"
          MOVE "Profile not found." TO LK-MESSAGE
          GOBACK
        END-IF

        PERFORM LOAD-EXPERIENCE
        PERFORM VARYING WS-ENTRY-INDEX FROM 1 BY 1
          UNTIL WS-ENTRY-INDEX > WS-EXPERIENCE-COUNT
            OR LK-VIEW-EXP-COUNT >= WS-MAX-EXPERIENCE-ENTRIES
          IF FUNCTION TRIM(WS-EXPERIENCE-USERNAME(WS-ENTRY-INDEX))
            = FUNCTION TRIM(LK-USERNAME)
            ADD 1 TO LK-VIEW-EXP-COUNT
            MOVE WS-EXPERIENCE-TITLE(WS-ENTRY-INDEX)
              TO LK-VIEW-EXP-TITLE(LK-VIEW-EXP-COUNT)
            MOVE WS-EXPERIENCE-COMPANY(WS-ENTRY-INDEX)
              TO LK-VIEW-EXP-COMPANY(LK-VIEW-EXP-COUNT)
            MOVE WS-EXPERIENCE-START-DATE(WS-ENTRY-INDEX)
              TO LK-VIEW-EXP-START-DATE(LK-VIEW-EXP-COUNT)
            MOVE WS-EXPERIENCE-END-DATE(WS-ENTRY-INDEX)
              TO LK-VIEW-EXP-END-DATE(LK-VIEW-EXP-COUNT)
            MOVE WS-EXPERIENCE-DESC(WS-ENTRY-INDEX)
              TO LK-VIEW-EXP-DESC(LK-VIEW-EXP-COUNT)
          END-IF
        END-PERFORM

        PERFORM LOAD-EDUCATION
        PERFORM VARYING WS-ENTRY-INDEX FROM 1 BY 1
          UNTIL WS-ENTRY-INDEX > WS-EDUCATION-COUNT
            OR LK-VIEW-EDU-COUNT >= WS-MAX-EDUCATION-ENTRIES
          IF FUNCTION TRIM(WS-EDUCATION-USERNAME(WS-ENTRY-INDEX))
            = FUNCTION TRIM(LK-USERNAME)
            ADD 1 TO LK-VIEW-EDU-COUNT
            MOVE WS-EDUCATION-DEGREE(WS-ENTRY-INDEX)
              TO LK-VIEW-EDU-DEGREE(LK-VIEW-EDU-COUNT)
            MOVE WS-EDUCATION-UNI(WS-ENTRY-INDEX)
              TO LK-VIEW-EDU-UNI(LK-VIEW-EDU-COUNT)
            MOVE WS-EDUCATION-START-YEAR(WS-ENTRY-INDEX)
              TO LK-VIEW-EDU-START-YEAR(LK-VIEW-EDU-COUNT)
            MOVE WS-EDUCATION-END-YEAR(WS-ENTRY-INDEX)
              TO LK-VIEW-EDU-END-YEAR(LK-VIEW-EDU-COUNT)
          END-IF
        END-PERFORM

        MOVE "Profile loaded." TO LK-MESSAGE.

      END PROGRAM EDITPROFILE.
